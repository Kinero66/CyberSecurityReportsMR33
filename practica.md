# Задание 1

<img width="1648" height="848" alt="Снимок экрана 2025-11-20 в 18 23 41" src="https://github.com/user-attachments/assets/501fb4ac-c164-4216-bb3b-6d53247ad1c2" />
Что видно из артефакта:

Src IP: 213.180.193.76, Dst IP: 10.0.2.7
Src Port: 443, Dst Port: 34568
Протокол: TLS 1.2, тип записи: Application Data (23)
Флоги TCP: PSH, ACK, длина полезной нагрузки TCP: 31 байт
В Wireshark указано: Application Data Protocol: Hypertext Transfer Protocol
→ то есть HTTPS-трафик (HTTP поверх TLS).
Это уже не handshake, а именно передача зашифрованных данных по установленному TLS-каналу.

Наличие шифрованного трафика TLS 1.2 с внешнего IP на нестандартный клиентский порт с типом записи Application Data может свидетельствовать о наличии скрытого C2-канала, маскирующегося под легитимный HTTPS и обходящего традиционные сигнатурные IDS, работающие только по L7-контенту.

Эксфильтрация данных по шифрованному веб-каналу

Если бы на 10.0.2.7 был скомпрометированный хост, он мог бы
выгружать данные на внешний сервер через HTTPS.
На уровне сети мы видим только то, что:
Есть устойчивая TLS-сессия,
Передаются небольшие блоки зашифрованных данных (31 байт и т.д.),
Содержимое скрыто за TLS 1.2.
Это вписывается в технику Exfiltration Over Web Services / HTTPS (T1041/T1567).

Так как полезная нагрузка полностью зашифрована (TLS Application Data), анализируемый артефакт укладывается в паттерн эксфильтрации по легитимному веб-каналу, когда атакующий использует HTTPS как «стеганографический туннель» для вывода конфиденциальных данных из внутреннего сегмента

# Задание 3
Классическое рукопожатие:
SYN → SYN/ACK → ACK.
<img width="1281" height="175" alt="Снимок экрана 2025-11-20 в 18 36 41" src="https://github.com/user-attachments/assets/2d72c3a5-b473-46b9-bf94-ad85e32a3a3f" />
<img width="1564" height="406" alt="Снимок экрана 2025-11-20 в 18 37 06" src="https://github.com/user-attachments/assets/e5368f1e-ddf9-4b16-ad72-7ba3f81e2a27" />

Публичный ключ 49:68:23:bd:11:23:9b:4c:08:94:15:2b:6e:89:85:7a:67:39:50:93:6b:87:ed:d8:47:13:ea:be:2d:23:48:65
Протокол обмена ключами ECDHE (Elliptic-Curve Diffie–Hellman Ephemeral), кривая x25519 (0x001d)

# Задание 4
1. Что означают строки Nmap

Общий формат строки Nmap:  
<порт>/<протокол>   <состояние>  <служба>   <конкретный продукт и версия>

1. 21/tcp   open  ftp         vsftpd 2.3.4  
   - 21/tcp – TCP-порт 21.  
   - open – порт открыт, на нём кто-то слушает соединения.  
   - ftp – протокол/служба: FTP-сервер (File Transfer Protocol).  
   - vsftpd 2.3.4 – конкретное ПО: FTP-сервер *vsftpd* версии 2.3.4.

2. 22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)  
   - 22/tcp – TCP-порт 22.  
   - open – открыт.  
   - ssh – служба SSH (удалённый защищённый доступ к оболочке).  
   - OpenSSH 4.7p1 Debian 8ubuntu1 – сервер SSH OpenSSH версии 4.7p1 из пакетов Debian/Ubuntu.  
   - (protocol 2.0) – используется протокол SSH версии 2.

3. 23/tcp   open  telnet      Linux telnetd  
   - 23/tcp – TCP-порт 23.  
   - open – открыт.  
   - telnet – незашифрованный удалённый доступ (Telnet).  
   - Linux telnetd – демон Telnet для Linux.

4. 25/tcp   open  smtp        Postfix smtpd  
   - 25/tcp – TCP-порт 25.  
   - open – открыт.  
   - smtp – почтовый протокол SMTP (Simple Mail Transfer Protocol).  
   - Postfix smtpd – почтовый сервер Postfix (его SMTP-демон).

 Какая ОС на атакуемой машине?

В выводе есть подсказки:

- У OpenSSH указано: Debian 8ubuntu1  
- У Apache: Apache httpd 2.2.8 ((Ubuntu) DAV/2)  
- В Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

3. Возможные уязвимости указанных сервисов

3.1. 3306/tcp open  mysql  MySQL 5.0.51a-3ubuntu5

Порт 3306 – стандартный порт MySQL. Версия 5.0.51a – очень старая и давно не поддерживается. Возможные проблемы:

- Множество известных CVE для ветки 5.0.x  
  - уязвимости, позволяющие:
    - вызвать DoS (краш сервера специальными запросами);  
    - обойти авторизацию или повысить привилегии в БД при определённых настройках.

- Слабые или дефолтные учётные данные
  - на учебных стендах MySQL часто настроен с простыми/пустыми паролями и доступом извне;
  - это позволяет подключиться к БД и получить все данные или выполнить произвольные SQL-запросы.

- Отсутствие шифрования соединения
  - по умолчанию трафик MySQL – в открытом виде, поэтому логины/пароли и данные можно перехватить в сети (sniffing).

- Избыточные привилегии
  - аккаунту БД могут быть даны права GRANT ALL откуда угодно (`'%'`),  
    что упрощает эксплуатацию даже при утечке одного логина/пароля.

В итоге: старая версия + типичные слабые настройки делают сервис очень уязвимым и отличной точкой входа

Порт 8180 – обычно альтернативный HTTP-порт, на котором крутится Apache Tomcat (Java-сервер приложений). Версия Coyote JSP engine 1.1 указывает на очень старый Tomcat (линейка 5.x / ранняя 6.x). Возможные уязвимости:

- Консоль управления Tomcat (Manager/Admin) с дефолтными/слабыми паролями
  - часто на учебных машинах оставляют web-консоль с заводскими логином/паролем;
  - через неё можно загрузить WAR-приложение и выполнить на сервере произвольный код (полноценный RCE).

- Старые уязвимости в ядре Tomcat
  - для таких версий существовали:
    - RCE-уязвимости при обработке специальных HTTP/AJP-запросов;  
    - XSS и информационные утечки через стандартные приложения/страницы;  
    - DoS при отправке «кривых» запросов.

- Небезопасные дефолтные настройки
  - доступные «примерные» приложения (`/examples`, /docs и т.п.), на которые иногда находятся отдельные дыры;
  - включённые листинги директорий, что облегчает разведку и поиск интересных файлов.
